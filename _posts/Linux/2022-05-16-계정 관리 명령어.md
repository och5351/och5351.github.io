---
title: "사용자 계정 관리 명령어(작성중)"
header:
  #image: /assets/images/linux/ubuntu_logo.png
  #caption: "Photo credit: [**Unsplash**](http://wiki.hash.kr/images/6/6e/%EC%9A%B0%EB%B6%84%ED%88%AC_%EB%A1%9C%EA%B3%A0.png)"
layout: posts
categories:
  - Linux
tags:
  - Linux
toc: true
toc_sticky: true

date: 2022-05-16
last_modified_at: 2022-05-17
---

# 사용자 계정 생성하기

<br>

사용자 계정을 생성할 때 useradd나 adduser 명령을 사용한다. 페도라에서는 adduser가 useradd에 대한 심벌릭 링크로 같은 명령이지만 우분투에서는 adduser가 별도의 명령으로 제공된다. 우분투에서는 adduser 명령을 사용할 것을 권고한다.

<br><br>

# useradd 명령으로 사용자 계정 생성하기

<br>

<table>
  <thead>
    <td colspan="1"><b>useradd</b></td>
  </thead>
  <tbody>
    <tr>
      <td>
        * 기능 : 사용자의 계정을 생성한다. <br>
        * 형식 : useradd [옵션] [로그인 ID] <br>
        * 옵션 : -u uid : UID를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -o : UID 의 중복을 허용한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -g gid : 기본 그룹의 GID를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -G gid : 2차 그룹의 GID를 지정한다.<br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -d 디렉터리명 : 홈 디렉터리를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -s 셸 : 기본 셸을 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -c 설명 : 사용자의 이름 등 부가적인 설명을 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -D : 기본값을 설정하거나 출력한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -e 유효 기간 : EXPIRE 항목을 설정한다(YYYY-MM-DD). <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -f 비활성 일수 : INACTIVE 항목을 설정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -k 디렉터리 : 계정 생성 시 복사할 초기 파일이나 디렉터리를 설정해놓은 디렉터리를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -m : 홈디렉터리를 생성한다.<br>
         사용 예 &nbsp useradd user2 <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp useradd -m -d /home/user2 user2 <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp useradd -m -d /home/user2 -u 2000 -g 100 -s /bin/ksh user2 <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp useradd -D -d /export/home
      </td>
    </tr>
  </tbody>
</table>

<br>

1. 옵션 없이 사용자 계정 생성하기

<br>

옵션 없이 useradd 명령으로 user2 계정을 만들면 /etc/passwd 파일에 user2 계정이 추간된다. useradd 명령을 옵션 없이 사용하면 홈 디렉터리가 생성되지 않고 기본 셸도 지정되지 않는다.

```bash
user1@myubuntu:~$ sudo useradd user2
user1@myubuntu:~$ tail -3 /etc/passwd
user1:x:1000:1000:user1,,,:/home/user1:/bin/bash
postfix:x:123:129::/var/spool/postfix:/bin/false
user2:x:1001:1001::/home/user2:
user1@myubuntu:~$ ls /home
user1
```

<br>

2. 옵션을 지정하여 사용자 계정 생성하기

<br>

다양한 옵션을 지정하여 사용자 계정을 생성해보자. 다음 예는 UID 2000번이 이미 있다는 메시지가 출력되어 다른 번호로 지정하는 것이다.

```bash
user1@myubuntu:~$ sudo useradd -s /bin/sh -m -d /home/user3 -u 2000 -g 1000 -G 3 user3
user3
user1@myubuntu:~$ grep user3 /etc/passwd
user3:x:2000:1000::/home/user3:/bin/sh
sys:x:3:user3
```

<br>

user3 계정의 암소를 설정하지 않았으며 /etc/shadow 파일을 확인해보면 !로 잠겨있다.

```bash
user1@myubuntu:~$ sudo tail -2 /etc/shadow
user2:!:17489:0:99999:7:::
user3:!:17489:0:99999:7:::
```

<br>

시스템 관리자는 사용자 계정을 추가할 때 반드시 초기 암호를 바로 설정하고, 사용자에게 초기 암호를 알려주고 바꾸도록 권고해야 한다.

```bash
user1@myubuntu:~$ sudo passwd user3
새 UNIX 암호 입력:
새 UNIX 암호 재입력:
passwd: 암호를 성공적으로 업데이트했습니다.
user1@myubuntu:~$ sudo tail -2 /etc/shadow
user2:!:17489:0:99999:7:::
user3:$6$LmXg/z.H......
```

<br>

3. 기본 설정 값 확인하기 -D 옵션

사용자 계정을 설정할 때 참고한는 기본 설정 값은 -D 옵션으로 확인할 수 있다.

```
user1@myubuntu:~$ useradd -D
GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/sh
SKEL=/etc/skel
CREATE_MAIL_SPOOL=no
```

- GROUP: 기본 등록 그룹의 GID로 100d은 users 그룹이다.
- HOME: 홈 디렉터리의 생성 위치이다.
- INACTIVE: -1이며 INACTIVE 기능이 비활성화된다. 0이면 암호가 만료되자마자 바로 계정이 잠긴다.
- EXPIRE: 게정 종료일을 지정한다.
- SHELL: 기본 로그인 셸을 지정한다.
- SKEL: 홈 디렉터리에 복사할 기본 환경 파일의 위치이다.
- CREATE_MAIL_SPOOL: 메일 디렉터리의 생성 여부를 지정한다.

이 항목들은 /etc/default/useradd 파일에 저장되어 있다.

```bash
user1@myubuntu:~$ cat /etc/default/useradd
# Default values for useradd(8)
#
# The SHELL variable specifies the default login shell on your
# system.
# Similar to DSHELL in adduser. However, we use "sh" here because
# useradd is a low level utility and should be as general
# as possible
SHELL=/bin/sh
(생략)
```

<br>

4. /etc/skel 디렉터리의 역할

사용자 계정을 생성할 때 시스템 운영 정책에 따라 사용자 계정의 홈 디렉터리에 공통으로 배포해야 할 파일이 있을 수 있다. 예를 들어 .bash_profile 같은 초기화 파일을 공통으로 작성해놓고 사용자 계정에 복사하는 것이다. 이런 경우 /etc/skel 디렉터리에 파일을 만들어 놓으면 사용자 계정을 생성할 때 자동으로 복사된다.

```
user1@myubuntu:~$ ls -a /etc/skel
.  ..  .bash_logout  .bashrc  .profile
```

<br><br>

# adduser 명령으로 사용자 계정 생성하기

adduser 명령은 useradd 명령처럼 옵션을 지정하면 사용자 계정을 등록할 수도 있고, 기본 설정에 따라 사용자 계정을 생성할 수도 있다. adduser 명령의 기본 형식은 다음과 같다.

<br>

<table>
  <thead>
    <td colspan="1"><b>adduser</b></td>
  </thead>
  <tbody>
    <tr>
      <td>
        * 기능 : 사용자의 계정을 생성한다. <br>
        * 형식 : useradd [옵션] [로그인 ID] <br>
        * 옵션 : -u uid : UID를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -o : UID 의 중복을 허용한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -g gid : 기본 그룹의 GID를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -G gid : 2차 그룹의 GID를 지정한다.<br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -d 디렉터리명 : 홈 디렉터리를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -s 셸 : 기본 셸을 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -c 설명 : 사용자의 이름 등 부가적인 설명을 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -D : 기본값을 설정하거나 출력한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -e 유효 기간 : EXPIRE 항목을 설정한다(YYYY-MM-DD). <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -f 비활성 일수 : INACTIVE 항목을 설정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -k 디렉터리 : 계정 생성 시 복사할 초기 파일이나 디렉터리를 설정해놓은 디렉터리를 지정한다. <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp -m : 홈디렉터리를 생성한다.<br>
         사용 예 &nbsp useradd user2 <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp useradd -m -d /home/user2 user2 <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp useradd -m -d /home/user2 -u 2000 -g 100 -s /bin/ksh user2 <br>
         &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp useradd -D -d /export/home
      </td>
    </tr>
  </tbody>
</table>
